<tool id="gene_fraction" name="Coverage Sampler" version="0.1.0">
    <description>A simple tool for calculating the amount of a gene that is covered by a sample of alignments</description>
    <requirements>
	<requirement type="package" version="0.1">coverage_sampler</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <command><![CDATA[
	csa
	  -ref_fp $reference
	  -sam_fp $sam
	  -min $min
	  -max $max
	  -t $threshold
	  -skip $skip
	  -samples $samples
	  -out_fp $output
    ]]></command>
    <inputs>
	<param type="data" name="reference" format="fasta" label="Reference sequence" />
	<param type="data" name="sam" format="sam" label="SAM file" />
	<param name="min" type="integer" label="Starting sample level"
	       value="1" min="1" max="100" help="(-min)" />
	<param name="max" type="integer" label="Ending sample level"
	       value="1" min="1" max="100" help="(-max)" />
	<param name="threshold" type="integer" label="Gene fraction threshold"
	       value="0" min="0" max="100" help="(-t)" />
	<param name="skip" type="integer" label="Amount of sample levels to skip"
	       value="1" min="1" max="100" help="(-skip)" />
	<param name="samples" type="integer" label="Iterations per sample level"
	       value="1" min="1" max="100" help="(-samples)" />
    </inputs>
    <outputs>
	<data name="output" format="tabular" />
    </outputs>
    <tests>
      <test>
          <param name="reference" value="ref.fa"/>
      	  <param name="sam" value="sampe.sam"/>
	  <param name="min" value="100"/>
	  <param name="max" value="100"/>
	  <param name="threshold" value="50"/>
	  <param name="skip" value="5"/>
	  <param name="samples" value="1"/>
      	  <output name="output" file="csa_result" ftype="tabular"/>
      </test>
      <test>
	  <param name="reference" value="ref.fa"/>
          <param name="sam" value="sampe.sam"/>
          <param name="min" value="100"/>
          <param name="max" value="100"/>
          <param name="threshold" value="80"/>
          <param name="skip" value="5"/>
          <param name="samples" value="1"/>
          <output name="output" file="csa_no_result" ftype="tabular"/>
      </test>
    </tests>
    <help>
<![CDATA[

**Coverage sampler**

Coverage sampler is a simple tool for calculating the amount of a gene that is covered by a sample of alignments. The tool takes
in as input a fasta and alignment file. The output of this program is a tab delimited text file describing the fraction of each gene
that was covered from a random sampling of alignments.

------

**Options**

         -min     INT    Starting level to sample reads from (level is in percent)
         -max     INT    Ending level to sample reads from (level is in percent)
         -skip    INT    Number of levels to skip
         -t       INT    Gene fraction threshold (only genes with a gene fraction greater than this threshold are output)
         -samples INT    Number of iterations per sample level
------

**Output**

Output of this program is a tab delimited text file with following:

Column	Description
Level		The sampling level alignments were taken at
Iteration	The ith iteration of the current sampling level
Gene Id		The reference sequence having a gene fraction greater than threshold
Gene Fraction	The overall fraction of the gene that was covered from the sample of alignments
Hits		The amount of times that the reference sequence was seen from the sample of alignments

------

**Development**

Development is being done on github_

.. _github: https://github.com/cdeanj/coverage_sampler

 ]]></help>
    <citations>
    </citations>
</tool>
